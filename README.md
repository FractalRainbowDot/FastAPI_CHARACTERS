# ‚öîÔ∏è FastAPI RPG Battle System

![Python](https://img.shields.io/badge/python-3.10+-blue.svg)
![FastAPI](https://img.shields.io/badge/FastAPI-0.109+-009688.svg)
![SQLAlchemy](https://img.shields.io/badge/SQLAlchemy-2.0+-red.svg)
![Alembic](https://img.shields.io/badge/Alembic-Migration-orange.svg)

–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π REST API –¥–ª—è –ø—Ä–æ—Å—Ç–æ–π RPG-–∏–≥—Ä—ã. –ü—Ä–æ–µ–∫—Ç –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π, —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏—Ö –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö SQLite –∏ –ø—Ä–æ–≤–æ–¥–∏—Ç—å –ø–æ—à–∞–≥–æ–≤—ã–µ —Å—Ä–∞–∂–µ–Ω–∏—è.

## üöÄ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞–º–∏ (CRUD):** –°–æ–∑–¥–∞–Ω–∏–µ, —á—Ç–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞, –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ ID, —É–¥–∞–ª–µ–Ω–∏–µ.
- **–ë–æ–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞:** –õ–æ–≥–∏–∫–∞ PvP –∏ PvE –±–æ–µ–≤, –≤–∫–ª—é—á–∞—è –∫–ª–∞—Å—Å–æ–≤—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏, –æ–ø—ã—Ç –∏ –ª–µ–≤–µ–ª-–∞–ø—ã.
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `SQLite` —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º –¥—Ä–∞–π–≤–µ—Ä–æ–º `aiosqlite`.
- **–ú–∏–≥—Ä–∞—Ü–∏–∏:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ö–µ–º–æ–π –ë–î —á–µ—Ä–µ–∑ `Alembic`.
- **–í–∞–ª–∏–¥–∞—Ü–∏—è:** –°—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ `Pydantic`.

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **–§—Ä–µ–π–º–≤–æ—Ä–∫:** FastAPI
- **ORM:** SQLAlchemy (Async)
- **–ú–∏–≥—Ä–∞—Ü–∏–∏:** Alembic
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** SQLite
- **–°–µ—Ä–≤–µ—Ä:** Uvicorn

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

```bash
# –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
python -m venv venv

# –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å (Windows)
venv\Scripts\activate

# –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å (Linux/macOS)
source venv/bin/activate
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–ú–∏–≥—Ä–∞—Ü–∏–∏)

–ü–µ—Ä–µ–¥ –ø–µ—Ä–≤—ã–º –∑–∞–ø—É—Å–∫–æ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã:

```bash
# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏
alembic upgrade head
```

*–ï—Å–ª–∏ –≤—ã –∏–∑–º–µ–Ω–∏–ª–∏ –º–æ–¥–µ–ª–∏, —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é:*
```bash
alembic revision --autogenerate -m "–æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π"
alembic upgrade head
```

### 4. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

```bash
# –ó–∞–ø—É—Å–∫ —Å –∞–≤—Ç–æ-–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π
uvicorn src.app.main:app --reload
```

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É:  
üëâ **http://127.0.0.1:8000/docs**

## üîå API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

### Database (`/database`)
- `POST /create_DB` ‚Äî –ü–µ—Ä–µ—Å–æ–∑–¥–∞–µ—Ç –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.
- `POST /add_character_to_DB` ‚Äî –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞.
- `POST /remove_character_from_DB` ‚Äî –£–¥–∞–ª–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –ø–æ ID.
- `GET /all_characters` ‚Äî –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π.
- `GET /character_info_by_id` ‚Äî –ü–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ –ø–æ ID.

### Battle (`/battle`)
- `POST /do_hit` ‚Äî **(PvP)** –ê—Ç–∞–∫–∞ –æ–¥–Ω–æ–≥–æ –∏–≥—Ä–æ–∫–∞ –¥—Ä—É–≥–∏–º. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç `id_self` –∏ `id_target`.
- `POST /fight_creep/{attacker_id}` ‚Äî **(PvE)** –ê—Ç–∞–∫–∞ —Å–ª—É—á–∞–π–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫—Ä–∏–ø–∞ (–û–≥—Ä–∞).
- `POST /heal/{character_id}` ‚Äî –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–¥–æ—Ä–æ–≤—å–µ –∏ –º–∞–Ω—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –ø–µ—Ä—Å–æ–Ω–∞–∂—É.
- `POST /heal_all` ‚Äî –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–¥–æ—Ä–æ–≤—å–µ –∏ –º–∞–Ω—É –≤—Å–µ–º –ø–µ—Ä—Å–æ–Ω–∞–∂–∞–º.

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

- `src/app/` ‚Äî –û—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
  - `database/` ‚Äî –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏ SQL-–∑–∞–ø—Ä–æ—Å—ã.
  - `routers/` ‚Äî –†–æ—É—Ç–µ—Ä—ã FastAPI (—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã).
  - `schemas/` ‚Äî Pydantic —Å—Ö–µ–º—ã –∏ SQLAlchemy –º–æ–¥–µ–ª–∏.
  - `battle/` ‚Äî –ú–æ–¥—É–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å—Ä–∞–∂–µ–Ω–∏–π.
- `migrations/` ‚Äî –§–∞–π–ª—ã –º–∏–≥—Ä–∞—Ü–∏–π Alembic.
- `alembic.ini` ‚Äî –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Alembic.
- `main.py` ‚Äî –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è Uvicorn.
- `README.md`
- `requirements.txt`
